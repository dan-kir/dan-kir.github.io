---
layout: post
title:  "Creating malware visualizations with Ghidra and CantorDust"
date:   '2022-06-05'
author: Dan Kir
tags:   
  - security
  - forensics
  - reverse engineering
description: >-
  Creating malware visualizations with Ghidra and CantorDust
---
|![Alt text](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/ghidra-cantordust.png "Tor exit relay probability history")|
|:--:|
|Cantordust Ghidra plugin - Visualization of REvil ransomware sample|

..cantor.dust.. is a binary visualization tool developed by Christopher Domas, first presented at Derbycon 2012. The original source code was never released. Then in 2020 a plugin for Ghidra was released by Battelle  - ([https://github.com/Battelle/cantordust](https://github.com/Battelle/cantordust))

Visualizing binaries in this way could assist forensics and reverse-engineering teams in the initial triage and categorization of unknown files. Battelle shared on their blog why they think this is important and details about how the visualizations work - ([https://inside.battelle.org/blog-details/battelle-publishes-open-source-binary-visualization-tool](https://inside.battelle.org/blog-details/battelle-publishes-open-source-binary-visualization-tool))


#### Installation
I've had the cantordust plugin running successfully on both Windows and Linux based installations of Ghidra.

The instructions provided by Battelle are enough to get started - ([https://github.com/Battelle/cantordust#installation-and-setup](https://github.com/Battelle/cantordust#installation-and-setup))


#### Examples
Here are some malware visualizations I've generated using samples from both  [theZoo](https://github.com/ytisf/theZoo) and [vx-underground](https://www.vx-underground.org)

|![AlienSpy](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/alienspy.png "AlienSpy")|![Cobalt Strike](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/cobaltstrike.png "Cobalt Strike")|
|:--:|:--:
|AlienSpy|CobaltStrike|
|![Darkside](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/darkside.png "Darkside")|![Emotet](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/emotet.png "Emotet")|
|Darkside|Emotet|
|![Mirai](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/mirai.png "Mirai")|![Pegasus](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/pegasus.png "Pegasus")|
|Mirai|Pegasus|
|![Petya](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/petya.png "Petya")|![REvil](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/revil.png "REvil")|
|Petya|REvil|
|![Shadow Hammer](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/shadowhammer.png "Shadow Hammer")|![Stuxnet](/imgs/2022-06-05-Creating-malware-visualizations-with-Ghidra-and-CantorDust/stuxnet.png "Stuxnet")|
|Shadow Hammer|Stuxnet|


#### Similar Projects
* https://rustrepo.com/repo/sharkdp-binocle-rust-data-visualization
* https://github.com/wapiflapi/veles
* https://github.com/VelocityRa/binviz


#### References

* https://sites.google.com/site/xxcantorxdustxx/
* https://github.com/Battelle/cantordust
* https://inside.battelle.org/blog-details/battelle-publishes-open-source-binary-visualization-tool
* https://www.youtube.com/watch?v=4bM3Gut1hIk
* https://bdtechtalks.com/2021/09/10/computer-vision-deep-learning-threat-detection/
